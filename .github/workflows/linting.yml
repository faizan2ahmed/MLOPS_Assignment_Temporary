name: Lint Code Base

on:
  push:
    branches: [ dev ]

jobs:
  flake8:

    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v2

    - name: Set up Python
      uses: actions/setup-python@v2
      with:
        python-version: 3.8

    - name: Install flake8
      run: pip install flake8

    - name: Run Linting
      run: make flake8

    - name: Create Pull Request to test branch
      uses: peter-evans/create-pull-request@v3
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        commit-message: Automated PR from dev to test
        title: "[AUTO-PR] New changes from dev"
        body: "This is an automated pull request to merge changes from dev to test."
        branch: "auto-pr-from-dev-to-test-${{ github.run_number }}"
        base: "test"
